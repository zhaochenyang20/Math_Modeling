# 总领

大家好，我们组由我（赵晨阳）、李飞翰与童雨轩三人组成。我们针对本次比赛分别建立了高维张量模型与时间窗口滑动平均模型。

针对问题一，我们构造清醒-麻醉-苏醒三个阶段的神经元特征张量，并利用欧式距离构造关联度矩阵和度矩阵，进行特征分解，最后谱聚类分析得出结论：

1. 同一脑区内的神经元具有相似的发放规律；
2. 全脑神经元具有多种发放规律，并可将脑区分为 4 组。

针对问题二，我们采用滑动窗口建模不同脑区的峰值特征，并绘制各组脑区的活跃曲线。我们发现：

1. 按照第一问中进行分组后，同组脑区的活跃程度曲线相似，而不同组间差异较大；
2. 我们进一步筛选出相对活跃阈值，绘制了各时间窗口中活跃脑区的空间分布。我们发现三个阶段内，同组脑区的空间分布和功能特点明显相关，而组间差异显著。

接下来有请李飞翰同学具体讲述我们针对问题一的建模方式。

# 问题一

针对问题1，“建立模型解释全脑神经元是否具有多种不同类型的发放规律”，我们考虑到脑区内细胞具有行为的相似性，而脑区之间在生物学功能上具有明显的差异。但是与此同时，不同脑区的细胞可能存在着相近的行为规律。于是自然而然的，我们设法将脑区进行聚类，以达到探究“不同发放规律”的归纳探究。

聚类需要在高维特征空间进行，因此特征的构建显得尤为重要。最开始，在直觉上，我们我们参考文献 (1) 中的定量建模方式，将“清醒-麻醉-苏醒”三阶段标注为 0, 1, 2，其次计算每个阶段内，该脑区的每个神经元细胞内外电势和对于阶段长度的均值，依次记为 p0, p1, p2；最后计算每个阶段内，该脑区的每个神经元的钙信号变化，对于阶段长度的均值，记为 c0, c1, c2。而后在此六维特征组成的特征空间对17个脑区类别进行k-means聚类，经过可视化验证，验证方法将在问题2中进行讲解，我们发现同一类内的特征曲线存在着明显的差异，且无法进行生物学的解释。可以看到图中，各大类之内的曲线并不具有明显的相似性，其结果也难以做生物学的解释。

进而我们设法提取出更具价值的特征。在后续的论文查询中，我们发现了脑科学研究中常用的特征：也即发放率，其计算方法为阶段内该脑区的每个神经元放电次数对于阶段长度的均值。进而我们分别计算三个脑区的发放率，并将其纳入特征张量，构造出了9维特征。在此维度上我们重新进行的上述的聚类，并分析可视化结果，我们发现虽然同一类内部分脑区特征曲线相近，但是会存在一些不符合类内特征的outlier。可以看到图中，大类内产生了明显相近的曲线特征，大类间存在明显差异，然而存在一些噪声曲线，其被分类到了错误的大类中。

进一步的，我们意识到不同脑区在稳态时，便应当具有各自独特的特征，而9维张量的建模明显淡化了这一区别，过度聚焦于麻醉实验的表现。因此我们单独计算了清醒阶段的特征，并将每一个脑区的特征建模为了一个3维向量与一个9维向量。为了将特征进行融合，我们分别根据这两个向量计算出了两个相似度矩阵，其元素(i, j)代表了第i个脑区与第j个脑区在该特征表示下的相似度。而后设定超参数将两个矩阵取加权和，进而得到了进行聚类的相似度矩阵。

考虑到k-means算法难以处理非线性可分的数据，结果又高度依赖于初始化的选择。因此我们采用了更加鲁棒且合理的谱聚类方法。

而前面提到的超参数，我们进行了0.01粒度的搜索，并设立了评价指标对聚类结果进行评估，具体来讲，考虑到聚类簇分离度与紧密度的评估效果，以及对簇数这一超参的评判，我们采用的是Davies-Bouldin指数。

针对簇数这一超参，我们进行了尝试，并建立了评价方法。具体而言，首先根据Davies-Bouldin指数，我们可以在数学层面进行评价，与此同时我们根据聚类结果的特征曲线合理性，生物学的可解释性进行综合评估。最终确定了四类这一超参。举例来说，在衡量数学效果与可视化效果相近的簇数4和5时，我们注意到了生物学理论的矛盾：5簇数中有一类被划分为麻醉阶段相对活跃，而查询得知其为运动和触觉相关的脑区，这与生物学知识相违背。

最后这是我们得出的聚类效果，可以看到，其被正确且明显地分为了四类，其中

- 第1组：麻醉时受到一定抑制，但仍相对活跃
- 第2组：麻醉时受到一定抑制，且全程都不太活跃
- 第3组：麻醉时受到明显抑制，以至于几乎不活动
- 第4组：几乎不受麻醉抑制，全程都较为活跃

以上便是我们针对问题一构建的数学模型及实验结果，下面由童雨轩同学讲解问题二的解题思路。

# 问题二

问题2要求我们“对清醒-麻醉-苏醒过程在脑区间的空间差异性和时间差异性进行识别和判断”，这其中可以提取出三个方面的数据：一是脑区活动，二是空间，三是时间。

基于控制变量的原则：

- 为了比较空间差异性，需要刻画脑区活动在整个时间线上的特征，再探究该特征与空间的关系。
- 同理，为了比较时间差异性，则需要想办法刻画脑区神经活动在整个观测范围内的特征，再探究该特征与时间的关系。

为了刻画脑区神经活动在整个时间线上的特征，我们先后尝试了三种方法。

第一种方法是尽可能利用所有可用数据，即所有观测时间点上的脑区活跃程度特征，但可视化形成的图像非常混乱，表明所有时间点的数据包含的信息过于细碎且重复，难以提取出合理的模式。

因此，我们希望能将特征在时间上进行压缩化简。为此，我们尝试了第二种方法：结合存在三个阶段的先验知识，仅考虑脑区在三个阶段的平均活跃程度。但实验发现，这样的特征损失了过多信息，同样难以提取出合理的模式。

为了找到最合适的压缩程度，我们采取了第三种方法：滑动窗口平均法，即将脑区活跃程度的特征在特定长度的时间窗口上取均值，而时间窗口的长度作为参数来调整。经过测试，我们选择了 100s 作为时间窗口的长度，这既能有效压缩重复信息，获得清晰的图像，也不至于丢失过多信息，导致脑区完全混为一团。

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/28e0d800-2456-471c-b9cc-f6f30903aa44/Untitled.png)

正如李飞翰同学先前提到的，脑区的活跃程度特征曲线具有组内的相似性，组间的差异性，这验证了问题一中对脑区分组的正确性。

在这一分组的基础上，我们画出了各组脑区的空间分布图，发现各组脑区内部空间分布具有相似的特点，而各组脑区之间的空间分布则有较大差异。

图中以右侧为前半脑，可以看到：

- 第1组：麻醉时受到一定抑制，但仍相对活跃的脑区——集中在观测范围中间
- 第2组：麻醉时受到一定抑制，且全程都不太活跃的脑区——分布在观测范围四周
- 第3组：麻醉时受到明显抑制，以至于几乎不活动的脑区——位于观测范围后半部分
- 第4组：几乎不受麻醉抑制，全程都较为活跃的脑区——位于观测范围前半部分

【四组脑区的空间分布图】

为了观察脑区神经活动在整个观测范围内的特征，我们选择绘制活跃脑区的空间分布图，并在不同时间段间进行比较，以探究脑区神经活动的空间特征在时间上的差异性。

我们选定了 50% 作为相对活跃阈值，即活跃程度在前 50% 的脑区才会被标记为活跃脑区，进而绘制在图中，而余下较不活跃的脑区则将被略去。

比较不同时间段的活跃脑区空间分布图，我们发现：一部分脑区始终都较为活跃，其他活跃脑区的空间分布则呈现阶段式的差异性。

图中仍然以右侧为前半脑，可以看到：

- 中部及中后部的脑区几乎全程都相对活跃
- 清醒阶段，侧后方脑区相对活跃
- 麻醉阶段，侧方脑区相对活跃，可能是因为其对麻醉药物产生了应激反应；
- 苏醒阶段，前方脑区相对活跃，可能是因为这部分脑区在大脑从麻醉效应的苏醒中发挥了作用。

# 总结

好的，综上所述，我们研究了清醒-麻醉-苏醒三个阶段小鼠皮层神经元的活动变化规律。首先通过尖峰放电率、电势均值与钙信号变化这三个特征，构造出脑区的表征张量，发现全脑神经元明确具有多种发放规律。随后，通过时间窗口滑动平均，我们得到小鼠不同窗口内活跃脑区的空间分布与不同脑区的活跃曲线，发现不同组脑区的空间分布和功能特点差异显著，而同组脑区则明显相关，进一步验证了脑区分组的正确性。本文所提出的模型具有数学上的合理性，同时也符合脑神经科学中的相关理论。